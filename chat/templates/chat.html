<!DOCTYPE html>
<html lang="en">
{% load static %}

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="{% static 'images/fav-icon-01.png' %}" style="border-radius:50% ;">
  <title>Trussrr Chat Room</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

  <!-- ==== css links ==== -->
  <link rel="stylesheet" href="{% static 'css/index-style.css'%}">
  <link rel="stylesheet" href="{% static 'css/style.css'%}">
</head>

<body>

  <!-- Old Chat design  -->
  <!-- <div class="d-flex flex-column justify-content-center ">
        <div class="d-flex align-items-center justify-content-between" style="width:150px;">
        <img src="{% static 'images/user.png' %}" style="border-radius:50%;" width=25 height=25 alt="...">
        <h5>${data1.message}</h5>
        </div>
        <h4 class="message">${data1.user}</h4>
       </div> -->

  <div class="">
    <nav class="navbar fixed-top navbar-expand-lg " style="background-color:rgb(237, 236, 236) ;">
      <div class="container-fluid ">
        <a class="navbar-brand for-add-paddingin-nav " href="{% url 'categories'%}">
          <p class="sf remove-margin" style="color:black ;"> <b>TRUSSR</b> </p>
          <p class="sf remove-margin text-sz-01" style="color:black ;"><b>rentals for creatives</b></p>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0 px-5">
            {% if user.is_authenticated and user_profile_exist %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'add_item' %}">
                <div class="btn btn-success">
                  <p class="sf text-sz-00 remove-margin">Add Item</p>
                </div>
              </a>
            </li>
            <!-- Button trigger modal -->
            <!-- <li class="nav-item">
                  <a class="nav-link" href="{% url 'add_item' %}" data-bs-toggle="modal" data-bs-target="#exampleModal6">
                    <div class="btn btn-success">
                      <p class="sf text-sz-00 remove-margin">Add Item</p>
                    </div>
                  </a>
                </li> -->
            <!-- Modal -->
            <!-- <div class="modal fade" id="exampleModal6" tabindex="-1" aria-labelledby="exampleModalLabel"
                  aria-hidden="true">
                  <div class="modal-dialog " id="modal-backdrop">
                    <div class="modal-content" id="modal-backdrop">
                      <div class="modal-header" id="modal-backdrop">
                        <h5 class="modal-title" id="exampleModalLabel">Cities</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body" id="modal-backdrop">
                        <div class="row">
                          <p class="sf text-sz text-center">Please Update Your profie first</p>
                        </div>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button> -->
            <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
            <!-- </div>
                    </div>
                  </div>
                </div> -->
            {% else %}
            <!-- Button trigger modal -->
            <li class="nav-item">
              <a class="nav-link" href="{% url 'add_item' %}" data-bs-toggle="modal" data-bs-target="#exampleModal5">
                <div class="btn btn-success">
                  <p class="sf text-sz-00 remove-margin">Add Item</p>
                </div>
              </a>
            </li>
            <!-- Modal -->
            <div class="modal fade" id="exampleModal5" tabindex="-1" aria-labelledby="exampleModalLabel"
              aria-hidden="true">
              <div class="modal-dialog " id="modal-backdrop">
                <div class="modal-content" id="modal-backdrop">
                  <div class="modal-header" id="modal-backdrop">
                    <h5 class="modal-title" id="exampleModalLabel">Add Item</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body" id="modal-backdrop">
                    <div class="row">
                      {% if not user.is_authenticated %}
                      <p class="sf text-sz text-center"> If You want to add item login first</p>

                      {% elif not user_profile_exist %}
                      <p class="sf text-sz text-center color-danger" style="color: red;">MUST HAVE
                        SOCIAL PROOF BEFORE ALLOWED TO ADD ITEM</p>
                      <div class="row">
                        <div class="col-12 d-flex justify-content-end">
                          <a href="{% url 'user_details' %}">
                            <button class="btn btn-primary">
                              <p class="sf text-sz-00 remove-margin "><b>Update
                                  profile</b></p>
                            </button>
                          </a>
                        </div>
                      </div>
                      {% endif %}
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                  </div>
                </div>
              </div>
            </div>
            {% endif %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'how_it_works' %}">
                <div class="btn btn-dark">
                  <p class="sf text-sz-00 remove-margin">How it works</p>
                </div>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'about_us' %}">
                <div class="btn btn-dark">
                  <p class="sf text-sz-00 remove-margin">About us</p>
                </div>
              </a>
            </li>
            {% if user.is_authenticated %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'user_details' %}">
                <div class="btn btn-dark">
                  <p class="sf text-sz-00 remove-margin">Profile</p>
                </div>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'logout_User' %}">
                <div class="btn btn-dark">
                  <p class="sf text-sz-00 remove-margin">Sign out</p>
                </div>
              </a>
            </li>
            {% else %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'sign_in' %}">
                <div class="btn btn-dark">
                  <p class="sf text-sz-00 remove-margin">Sign in</p>
                </div>
              </a>
            </li>
            {% endif %}

            <!-- <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                      Dropdown
                    </a>
                    <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="#">Action</a></li>
                      <li><a class="dropdown-item" href="#">Another action</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="#">Something else here</a></li>
                    </ul> -->
            </li>
            <!-- <li class="nav-item">
                    <a class="nav-link disabled">Disabled</a>
                  </li> -->
          </ul>
          <!-- <form class="d-flex" role="search">
                  <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                  <button class="btn btn-outline-success" type="submit">Search</button>
                </form> -->
        </div>
      </div>
    </nav>
  </div>
  <div class="chat_log mt-5 pt-1">
    <div class="container mt-4  d-flex justify-content-between flex-column"
      style="height:290px;overflow-x: auto; margin-top: 30px;">
      <div>
        <div class="border-bottom d-flex align-items-center justify-content-between" style="height:70px;">
          <h2 class="text-primary float-start px-3">Trusrr Chat Room</h2>
          <!-- <h2 class="float-end user">2 People</h2> -->
        </div>
        <div class="chatroom py-3 px-3">
          <!-- <div class="row" style="background-color:rgb(214, 213, 213) ;">
                        <div class="col-xl-1 col-lg-1 col-md-3 col-sm-3 col-12 ">
                            <div class="user-img px-1 mt-2">
                                <img src="{% static 'images/user.png' %}" style="border-radius:2%;" width=75 height=75
                                    alt="...">
                            </div>
                            <div class="user-name mt-1 px-1">
                                <p class="lorin text-sz-01 remove-margin"><b> USer nAme</b></p>
                            </div>
                        </div>
                        <div class="col-xl-11 col-lg-11 col-md-9 col-sm-9 col-12  px-1 mt-2 ">
                            <p class="lorin text-sz-01 remove-margin">
                                Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptates sit sint velit autem ex dolorem molestiae tempore suscipit deserunt corporis porro esse veritatis, ut quaerat temporibus cumque nisi! Totam porro reiciendis sed, odio doloribus quam quia rem saepe voluptatibus? Dolorum quidem aperiam excepturi voluptatibus quae officia expedita, perspiciatis dignissimos ipsam hic sapiente ipsa magnam architecto, at adipisci natus labore sint repellendus perferendis vitae odit esse? Molestias fugit laborum excepturi maiores velit eaque reiciendis delectus fugiat neque voluptas nisi, iste nemo explicabo quo tenetur dolores saepe ipsa culpa quidem! Aliquam, quas assumenda! Perspiciatis sint illum culpa! Quos rem velit eum ut?
                            </p>
                        </div>
                        <hr class="remove-margin">
                    </div> -->
        </div>
      </div>


    </div>
    <div class="container">
      <div class="">
        <div class="row">
          <div class="my-2">
            <textarea placeholder="Message Here" class="form-control" id="user_msg" rows="5"></textarea>
          </div>
          <div class="row ms-1 ps-1 py-2">
            <button class="btn btn-outline-dark" id="msg_send_btn">Send</button>
          </div>
        </div>
        <!-- <input type="text" placeholder="Message Here" class="form-control" id="user_msg"> -->
      </div>
    </div>
  </div>
  <!-- Fotter Here  -->
  <footer style="background-color:	#F8F9FA; color: black;">
    <div class="container-fluid">
      <hr>
      <div class="row py-3">
        <div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 col-6 pt-3 for-content-center ">
          <div class="fotter-content">
            <p class="sf text-sz"><b>Top Cities</b></p>
            {% for city in city_data_for_all %}
            <a href="{% url 'search' city.id  %}" class="for-anchor-tag">
              <p class="sf text-sz-00 remove-margin">{{city.city_name}} ></p>
            </a>
            {% endfor %}
            <a href="#" class="for-anchor-tag">
              <p class="sf text-sz-00 remove-margin">Others ></p>
            </a>

            <!-- <a href="https://www.paypal.com/donate/?hosted_button_id=PADSLJRYN9T2L"> donate us</a> -->
            <!-- <a href="#" class="for-anchor-tag"><p class="sf text-sz-00 remove-margin">New York ></p></a>
        <a href="#" class="for-anchor-tag"><p class="sf text-sz-00 remove-margin">Atlanta  ></p></a>
        <a href="#" class="for-anchor-tag"><p class="sf text-sz-00 remove-margin">San Francisco ></p></a>
        <a href="#" class="for-anchor-tag"><p class="sf text-sz-00 remove-margin">Seattle ></p></a>
        <a href="#" class="for-anchor-tag"><p class="sf text-sz-00 remove-margin">Chicago ></p></a>
        <a href="#" class="for-anchor-tag"><p class="sf text-sz-00 remove-margin">San Diego ></p></a> -->
          </div>
        </div>
        <div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 col-6  pt-3 for-content-center remove-padding">
          <div class="fotter-content">
            <p class="sf text-sz"><b>How It Works</b></p>
            <a href="{% url 'how_it_works' %}" class="for-anchor-tag">
              <p class="sf text-sz-00 remove-margin">How it works ></p>
            </a>
            <!-- <a href="{% url 'how_it_works' %}" class="for-anchor-tag"><p class="sf text-sz-00 remove-margin">Listing for rent ></p></a>
        <a href="{% url 'how_it_works' %}" class="for-anchor-tag"><p class="sf text-sz-00 remove-margin">Support center ></p></a> -->
            <a href="{% url 'legal_diclaimer' %}" class="for-anchor-tag">
              <p class="sf text-sz-00 remove-margin">Legal Disclaimer ></p>
            </a>
            {% if user.is_authenticated %}
            <a href="{% url 'user_details' %}" class="for-anchor-tag">
              <p class="sf text-sz-00 remove-margin">User details ></p>
            </a>
            {% else %}
            <a href="{% url 'sign_up' %}" class="for-anchor-tag">
              <p class="sf text-sz-00 remove-margin">Sign up ></p>
            </a>
            {% endif %}
            <a href="{% url 'faqs' %}" class="for-anchor-tag">
              <p class="sf text-sz-00 remove-margin">FAQs ></p>
            </a>
            <p class="sf text-sz mt-2"><b>Join Us</b></p>
            <!-- <a href="#" class="for-anchor-tag"><p class="sf text-sz-00 remove-margin">Our Blog ></p></a> -->
            <a href="https://www.facebook.com/trussrr/" target="_blank" class="for-anchor-tag">
              <p class="sf text-sz-00 remove-margin">Facebook ></p>
            </a>
            <a href="https://www.instagram.com/trussrr_/" target="_blank" class="for-anchor-tag">
              <p class="sf text-sz-00 remove-margin">Instagram ></p>
            </a>
          </div>
        </div>

        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12  pt-3 for-content-center">
          <div class="fotter-content">

            <div class="container-fluid">
              <div class="row">
                <p class="sf text-sz text-center"><b>Support Us</b></p>
                <div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 col-6 d-flex flex-column justify-content-center">
                  <!-- Button trigger modal -->
                  <div class="qr d-flex  justify-content-center">
                    <a href="" class="for-line-remove-a-tag" data-bs-toggle="modal" data-bs-target="#exampleModal100">
                      <!-- <p class="sf text-sz-00 remove-margin "> Support Us</p> -->
                      <img class="img-fluid" width="110px" src="{% static 'images/qr.jpeg'%}" alt="">
                    </a>
                  </div>
                  <div>
                    <p class="sf text-sz text-center remove-margin" style="color:blue"> VENMO</p>
                  </div>
                  <!-- Modal -->
                  <div class="modal fade" id="exampleModal100" tabindex="-1" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog  ">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title" id="exampleModalLabel">Support Us</h5>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                          <div class="row">
                            <div class="col-12 for-content-center">
                              <p class="sf text-sz-00">Scan QR code to donate!</p>
                            </div>
                            <div class="col-12 for-content-center">
                              <img class="img-fluid" width="500px" src="{% static 'images/ven.png'%}" alt="">
                            </div>
                          </div>


                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                          <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  class="col-xl-3 col-lg-3 col-md-3 col-sm-6 col-6 col-sm-6 d-flex flex-column justify-content-center">
                  <!-- Button trigger modal -->
                  <div class="qr d-flex  justify-content-center">
                    <a href="" class="for-line-remove-a-tag" data-bs-toggle="modal" data-bs-target="#exampleModal101">
                      <!-- <p class="sf text-sz-00 remove-margin "> Support Us</p> -->
                      <img class="img-fluid" width="110px" src="{% static 'images/tr-qr.png'%}" alt="">
                    </a>
                  </div>
                  <div>
                    <p class="sf text-sz text-center remove-margin text-muted"> CashApp</p>
                  </div>
                  <!-- Modal -->
                  <div class="modal fade" id="exampleModal101" tabindex="-1" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog  ">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title" id="exampleModalLabel">Support Us</h5>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                          <div class="row">
                            <div class="col-12 for-content-center">
                              <p class="sf text-sz-00">Scan QR code to donate!</p>
                            </div>
                            <div class="col-12 for-content-center">
                              <img class="img-fluid" width="500px" src="{% static 'images/Trusserr_qr.png'%}" alt="">
                            </div>
                          </div>


                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                          <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  class="col-xl-3 col-lg-3 col-md-3 col-sm-6 col-6 col-sm-6 d-flex flex-column justify-content-center">
                  <!-- Button trigger modal -->
                  <div class="qr d-flex  justify-content-center">
                    <a href="" class="for-line-remove-a-tag" data-bs-toggle="modal" data-bs-target="#exampleModal102">
                      <!-- <p class="sf text-sz-00 remove-margin "> Support Us</p> -->
                      <img class="img-fluid" width="110px" src="{% static 'images/p-qr.png'%}" alt="">
                    </a>
                  </div>
                  <div>
                    <p class="sf text-sz text-center remove-margin" style="color:rgb(52, 18, 131)"> PAYPAL</p>
                  </div>
                  <!-- Modal -->
                  <div class="modal fade" id="exampleModal102" tabindex="-1" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog  ">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title" id="exampleModalLabel">Support Us</h5>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                          <div class="row">
                            <div class="col-12 for-content-center">
                              <p class="sf text-sz-00">Scan QR code to donate!</p>
                            </div>
                            <div class="col-12 for-content-center">
                              <img class="img-fluid" width="500px" src="{% static 'images/paypal_qr.png'%}" alt="">
                            </div>
                          </div>


                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                          <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  class="col-xl-3 col-lg-3 col-md-3 col-sm-6 col-6 col-sm-6 d-flex flex-column justify-content-center">
                  <!-- Button trigger modal -->
                  <div class="qr d-flex  justify-content-center">
                    <a href="" class="for-line-remove-a-tag" data-bs-toggle="modal" data-bs-target="#exampleModal103">
                      <!-- <p class="sf text-sz-00 remove-margin "> Support Us</p> -->
                      <img class="img-fluid" width="110px" src="{% static 'images/z-qr.png'%}" alt="">
                    </a>
                  </div>
                  <div>
                    <p class="sf text-sz text-center remove-margin" style="color:blueviolet"> Zelle</p>
                  </div>
                  <!-- Modal -->
                  <div class="modal fade" id="exampleModal103" tabindex="-1" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog  ">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title" id="exampleModalLabel">Support Us</h5>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                          <div class="row">
                            <div class="col-12 for-content-center">
                              <p class="sf text-sz-00">Scan QR code to donate!</p>
                            </div>
                            <div class="col-12 for-content-center">
                              <img class="img-fluid" width="500px" src="{% static 'images/zelle_qr.png'%}" alt="">
                            </div>
                          </div>


                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                          <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-12 mt-4 d-flex flex-column justify-content-center text-center">
                  <form action="https://www.paypal.com/donate" method="post" target="_top">
                    <input type="hidden" name="hosted_button_id" value="PADSLJRYN9T2L" />
                    <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0"
                      name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate
                with PayPal button" />
                    <img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif " width="2" height="1" />
                  </form>
                </div>
              </div>
            </div>

            <!-- <a href="#" class="for-anchor-tag"><p class="sf text-sz-00 remove-margin">Atnis : (9564565) 673-4587546  ></p></a> -->
            <!-- <img class="img-fluid"  width="100px" src="{% static 'images/qr.jpeg'%}" alt=""> -->
          </div>
        </div>
      </div>
    </div>

  </footer>
  <!-- == Fotter End === -->


  <!-- ==== Chat functionolity === -->
  <script>
    const ws = new WebSocket('ws://127.0.0.1:8000/ws/chat/')
    ws.onopen = () => {
      console.log('opened')
      ws.send(JSON.stringify({
        command: 'connected',

      }))
    }
    const button = document.querySelector('#msg_send_btn');

  
    button.addEventListener("click", () => {
      // alert("I am working")
      const input_msg = document.querySelector('#user_msg');
      ws.send(JSON.stringify(
        {
          command: 'send',
          message: input_msg.value,
          user: '{{user}}',
        }
      ))


      input_msg.value = ""  

      console.log(input_msg, 'This is  message')

    })

    // alert("I am here")
    ws.onmessage = (e) => {
      const data1 = JSON.parse(e.data);
      console.log(data1)
      if (data1.command == 'received') {
        const chat = document.getElementsByClassName("chatroom")[0];

        const message = ` 
                <div class="row" style="background-color:rgb(214, 213, 213) ;">
            <div class="col-xl-1 col-lg-1 col-md-3 col-sm-3 col-12 ">
                <div class="user-img px-1 mt-2">
                    <img src="{% static 'images/user.png' %}" style="border-radius:2%;" width=75 height=75 alt="...">
                </div>
                <div class="user-name mt-1 px-1">
                    <p class="lorin text-sz-01 remove-margin"><b>${data1.user}</b></p>
                </div>
            </div>
            <div class="col-xl-11 col-lg-11 col-md-9 col-sm-9 col-12 px-1 mt-2 ">
                <p class="lorin text-sz-01 remove-margin">
                    ${data1.message}
                </p>
            </div>
            <hr class="remove-margin">
            
          </div>
          <br>
                `
        chat.innerHTML += message;
        console.log(data1.user, data1.message, message)
      }
      else {
        const user = document.getElementsByClassName('user')[0];
        // user.innerHTML = data1.no + ' People'
      }


    }
  </script>
</body>

</html>